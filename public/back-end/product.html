<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content="Vali is a responsive and free admin theme built with Bootstrap 4, SASS and PUG.js. It's fully customizable and modular.">
    <!-- Twitter meta-->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:site" content="@pratikborsadiya">
    <meta property="twitter:creator" content="@pratikborsadiya">
    <!-- Open Graph Meta-->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Vali Admin">
    <meta property="og:title" content="Vali - Free Bootstrap 4 admin theme">
    <meta property="og:url" content="http://pratikborsadiya.in/blog/vali-admin">
    <meta property="og:image" content="http://pratikborsadiya.in/blog/vali-admin/hero-social.png">
    <meta property="og:description" content="Vali is a responsive and free admin theme built with Bootstrap 4, SASS and PUG.js. It's fully customizable and modular.">
    <title>Admin</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="app sidebar-mini">
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="index.html">Coza</a>
      <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
      <!-- Navbar Right Menu-->
      <ul class="app-nav">
        <li class="app-search">
          <input class="app-search__input" type="search" placeholder="Search">
          <button class="app-search__button"><i class="fa fa-search"></i></button>
        </li>
        <!-- User Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown" aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item" href="page-user.html"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
            <li><a class="dropdown-item" href="page-user.html"><i class="fa fa-user fa-lg"></i> Profile</a></li>
            <li><a class="dropdown-item" href="page-login.html"><i class="fa fa-sign-out fa-lg"></i> Logout</a></li>
          </ul>
        </li>
      </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
      <div class="app-sidebar__user"><img class="app-sidebar__user-avatar" src="../back-end/images/img.jpg" style="width:50px;height:50px" alt="User Image">
        <div>
          <p class="app-sidebar__user-name">Hoang Anh</p>
          <p class="app-sidebar__user-designation">Frontend Developer</p>
        </div>
      </div>
      <ul class="app-menu">
        <li><a class="app-menu__item" href="index.html"><i class="app-menu__icon fa fa-dashboard"></i><span class="app-menu__label">Dashboard</span></a></li>
        <li><a class="treeview-item" href="category.html"><i class=" icon fa fa-copyright"></i>Loại sản phẩm</a></li>
        <li><a class="treeview-item active" href="product.html"><i class="icon fa fa-list-ul"></i>Sản Phẩm</a></li>
        <li><a class="treeview-item" href="post.html"><i class="icon fa fa-hashtag"></i>Bài Viết</a></li>
        <li><a class="treeview-item" href="contact.html"><i class="icon fa fa-bell"></i>Liên Hệ</a></li>
        <li><a class="treeview-item " href="slider.html"><i class="icon fa fa-expand"></i>Slider</a></li>


    </aside>
    <main class="app-content">
      <div class="app-title">
        <div>
          <h1><i class="icon fa fa-list-ul"></i> Sản Phẩm</h1>
        </div>
        <ul class="app-breadcrumb breadcrumb">
          <li class="breadcrumb-item"><i class="fa fa-home fa-lg"></i></li>
          <li class="breadcrumb-item"><a href="#">Sản Phẩm</a></li>
        </ul>
      </div>
      <table>
      </table>
      <table class="table table-striped" style="background-color: white;text-align: center">
            <thead>
              <tr>
                <th scope="col">id_sanpham</th>
                <th scope="col">Tên sản phẩm</th>
                <th scope="col">Tên danh mục</th>
                <th scope="col">Giá</th>
                <th scope="col">Giảm giá</th>
                <th scope="col">Ảnh</th>
                <th scope="col">Số lượng</th>
                <th scope="col"><a class="btn btn-success" href="product-add.html">Thêm Sản Phẩm</a></th>
                
              </tr>
            </thead>
            <tbody>
              <!-- / -->
              
            </tbody>
          </table>
          <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
          <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
          <script>
              var apiUrl = "http://localhost:3000/product";
              var apiUrlCategory="http://localhost:3000/category";
              axios.get(apiUrl)
                .then(resporn => {
                  if (resporn.statusText === "OK") {
                    var data = resporn.data;
                    


                    // apiGetCategory= apiUrlCategory+"/"+element.id;
                    //   axios.get(apiGetCategory)
                    //   .then(resporn=>{
                    //   a=resporn.name
                    //   })

                    var content = ``;

                    data.forEach(element => {
                      content += `
                            <tr id="row-${element.id}">
                                <td>${element.id}</td>
                                <td>${element.name}</td>  
                                <td>${element.categoryId}</td>                 
                                <td>${element.price}</td>
                                <td>${element.sale}</td>
                                <td> <img src="${element.image}" style="width:100px;height:100px" alt=""></td>
                                <td>${element.quantity}</td>
                                <td>
                                  <a href="product-edit.html?id=${element.id}"class="btn btn-danger">Sửa</a>
                                    <button class="btn btn-dark" onclick="xoa_danhmuc(${element.id})">Xóa</button></td>
                            </tr>
                            `
                      document.querySelector("tbody").innerHTML = content;
                    });
                  }
                })
                  function xoa_danhmuc(id) {
                    //confirm
                    Swal.fire({
                      title: 'Bạn có chắc chắn xóa?',
                      text: "Sau khi xóa sẽ không lấy lại được dữ liệu!",
                      icon: 'warning',
                      showCancelButton: true,
                      confirmButtonColor: '#3085d6',
                      cancelButtonColor: '#d33',
                      confirmButtonText: 'Đồng ý!',
                      cancelButtonText: 'Không đồng ý!'
                    }).then((result) => {
                      if (result.value) {
                        var deleteUrl = apiUrl + "/" + id;
                        axios.delete(deleteUrl)
                          .then(resporn => {
                          })
                          .then(() => {
                            var removeElement = document.querySelector("#row-" + id)
                            removeElement.remove();
                            Swal.fire({
                              position: 'bottom-end',
                              icon: 'success',
                              title: 'Đã xóa',
                              showConfirmButton: false,
                              timer: 1500
                            })
                          })
                      }
                    })
                  }
            </script>
    </main>
    <!-- Essential javascripts for application to work-->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <!-- The javascript plugin to display page loading on top-->
    <script src="js/plugins/pace.min.js"></script>

  </body>
</html>